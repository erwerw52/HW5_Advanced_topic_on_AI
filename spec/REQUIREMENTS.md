# 自動生成 PPT 系統 - 需求規格書

> 專案目標：根據輸入文檔，透過 AI 自動分析內容並選擇適合的模板，生成專業的 PowerPoint 簡報

---

## 📋 功能需求

### 1. 文檔輸入模組

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| F-1.1 | 支援 `.txt` 純文字檔案輸入 | 🔴 必要 |
| F-1.2 | 支援 `.md` Markdown 檔案輸入 | 🔴 必要 |
| F-1.3 | 支援 `.docx` Word 檔案輸入 | 🔴 必要 |
| F-1.4 | 自動識別文檔結構（標題、段落、列表） | 🔴 必要 |

---

### 2. AI 內容分析模組

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| F-2.1 | 使用開源/免費 LLM 模型進行內容分析 | 🔴 必要 |
| F-2.2 | 自動判斷文檔主題類型（技術/商務/教育/學術） | 🔴 必要 |
| F-2.3 | 自動提取重點摘要與分點內容 | 🔴 必要 |
| F-2.4 | 根據內容特性推薦適合的模板風格 | 🔴 必要 |

#### 可選用的免費/開源模型

| 模型 | 來源 | 特點 | 狀態 |
|------|------|------|------|
| `Gemini API` | Google | 有免費額度、效果好 | ✅ **採用** |
| ~~`Llama 3.1/3.2`~~ | ~~Meta (Ollama)~~ | ~~免費、可離線~~ | 不採用 |
| ~~`Mistral 7B`~~ | ~~Mistral AI~~ | ~~輕量~~ | 不採用 |
| ~~`Groq API`~~ | ~~Groq~~ | ~~速度快~~ | 不採用 |
| ~~`OpenRouter`~~ | ~~多模型聚合~~ | ~~部分免費~~ | 不採用 |

---

### 3. 模板管理模組

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| F-3.1 | 內建至少 3-5 種預設模板風格 | 🔴 必要 |
| F-3.2 | 模板包含：標題頁、內容頁、結尾頁佈局 | 🔴 必要 |
| F-3.3 | 支援自訂模板擴充 | 🟡 選配 |

#### 模板來源方案

| 來源 | 說明 |
|------|------|
| **方案 A：程式碼生成** | 使用 `python-pptx` 直接用程式碼定義模板樣式（配色、字體、佈局） |
| **方案 B：免費模板網站** | 從免費資源下載 `.pptx` 模板，程式讀取並填充內容 |
| **方案 C：混合方式** | 預設用程式碼生成，但支援載入外部 `.pptx` 模板 |

##### 免費模板資源

- [SlidesCarnival](https://www.slidescarnival.com/) - 免費 PPT 模板
- [SlidesGo](https://slidesgo.com/) - 部分免費
- [ALLPPT](https://www.free-powerpoint-templates-design.com/) - 免費商用

> **建議**：採用 **方案 A（程式碼生成）** 作為主要方式，確保可控性

---

### 4. PPT 生成模組

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| F-4.1 | 自動生成標題頁（標題 + 副標題/作者） | 🔴 必要 |
| F-4.2 | 自動生成內容頁（支援多種佈局） | 🔴 必要 |
| F-4.3 | 自動生成結尾頁（感謝/Q&A） | 🟡 選配 |
| F-4.4 | 內容過長時自動分頁 | 🔴 必要 |
| F-4.5 | 輸出為 `.pptx` 格式 | 🔴 必要 |

---

### 5. 使用者介面

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| F-5.1 | 簡易 Web 介面（採用 **Gradio**） | 🔴 必要 |

> **選擇 Gradio 的理由：**
> - 輕量、程式碼簡潔（比 Streamlit 少 50% 程式碼）
> - 內建檔案上傳/下載元件
> - 支援一鍵部署到 **Hugging Face Spaces**（完全免費）
> - 自動生成 API 端點，方便後續整合

#### 免費部署方案

| 平台 | 說明 | 推薦度 |
|------|------|--------|
| **Hugging Face Spaces** | 免費託管 Gradio 應用，無需伺服器 | ⭐⭐⭐⭐⭐ |
| Render | 免費方案有限制，但可用 | ⭐⭐⭐ |
| Railway | 有免費額度 | ⭐⭐⭐ |

---

## 🔧 非功能需求

| 需求編號 | 需求描述 | 優先級 |
|---------|---------|--------|
| NF-1 | 支援 Python 3.9+ 環境 | 🔴 必要 |
| NF-2 | 依賴套件易於安裝（pip install） | 🔴 必要 |
| NF-3 | 處理單一文檔時間 < 30 秒 | 🟡 選配 |
| NF-4 | 提供清晰的錯誤提示 | 🔴 必要 |

---

## 📁 預期專案結構

```
hw5/
├── main.py                 # 主程式入口
├── requirements.txt        # 依賴套件
├── README.md              # 使用說明
├── REQUIREMENTS.md        # 本需求文件
│
├── src/
│   ├── __init__.py
│   ├── document_parser.py  # 文檔解析模組
│   ├── ai_analyzer.py      # AI 分析模組
│   ├── template_manager.py # 模板管理模組
│   └── ppt_generator.py    # PPT 生成模組
│
├── templates/              # 模板定義
│   └── styles.py           # 模板風格設定
│
├── input/                  # 輸入文檔存放
│   └── sample.md
│
└── output/                 # 生成的 PPT 存放
    └── (generated files)
```

---

## 🚀 使用流程

```
1. 準備輸入文檔 (input/your_document.md)
          ↓
2. 執行命令：python main.py input/your_document.md
          ↓
3. AI 自動分析內容並選擇模板
          ↓
4. 生成 PPT 至 output/ 資料夾
```

---

## ❓ 待確認事項

~~請確認以下選項，以便進入開發階段：~~

### 1. AI 模型選擇
- [ ] ~~A. Ollama 本地模型（需安裝 Ollama，完全免費離線）~~
- [ ] ~~B. Groq API（免費額度，需申請 API Key）~~
- [x] **C. Google Gemini API**（免費額度，需申請 API Key）✅ 已確認
- [ ] ~~D. 其他：___huggingface?___~~

### 2. 模板風格偏好
- [x] 預設包含以下 3 種風格：✅ 已確認
  - [x] 專業技術風格（藍色系、簡潔）
  - [x] 學術研究風格（素雅、正式）
  - [x] 簡約風格（黑白灰、極簡）

### 3. Web 框架與部署
- [x] **Gradio** + **Hugging Face Spaces** 免費部署 ✅ 已確認

### 4. 其他補充需求
> ✅ 目前無額外需求

---

## 📝 修訂紀錄

| 版本 | 日期 | 修改內容 |
|------|------|---------|
| v1.0 | 2024-11-29 | 初版需求文件 |
| v1.1 | 2024-11-29 | 確認採用 Gemini API、Gradio + HF Spaces 部署、3 種模板風格 |
